machine:
  node:
    version: 6.10.3

general:
  artifacts:
    - dist

test:
  override:
    - echo 'no tests'

dependencies:
  override:
    - npm install --dev
    - npm install -g gulp

compile:
  override:
  - gulp

deployment:
  prod:
    branch: master
    commands:
      - aws s3 sync dist/ s3://amanda-therapy-website/www/ --delete
      - aws s3 cp s3://amanda-therapy-website/www/ s3://amanda-therapy-website/www/ --exclude "*" --include "*.jpg" --include "*.png" --include "*.ico" --recursive --metadata-directive REPLACE --expires 2034-01-01T00:00:00Z --acl public-read --cache-control max-age=2592000,public
      - aws configure set preview.cloudfront true
      - aws cloudfront create-invalidation --distribution-id E2L2WKPDSN8BF3 --paths /index.html
